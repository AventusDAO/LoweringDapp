name: lowering dapp docker

on:
  workflow_dispatch:
  push:
    branches: [master, feat/*, bug/*]
  pull_request:
    branches:
      - master

jobs:
  build-dapp:
    name: (AVN) build docker lowering-dapp
    uses: ./.github/workflows/docker-build.yaml
    with:
      config_creds: false
      aws_region: eu-west-1
      aws_account_id: 931945598683
      short_image_name: lowering
      ecr_repository_prefix: dapps

  ew-docker-dapp:
    name: (EW) build docker lowering-dapp
    #TODO: re-add the 'if' as soon as the dapp is tested on EW
    #if: ${{ github.event_name == 'workflow_dispatch' && github.ref_name == 'master' }}
    uses: ./.github/workflows/docker-build.yaml
    with:
      config_creds: false
      aws_region: us-east-1
      aws_account_id: 541507968610
      short_image_name: lowering
      ecr_repository_prefix: dapps
